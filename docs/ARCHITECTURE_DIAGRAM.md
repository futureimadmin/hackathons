# eCommerce AI Analytics Platform - Architecture Diagram

## Overview

This document describes the interactive architecture diagram that visualizes the complete end-to-end system architecture including all 5 AI systems, user interface, DMS platform with data migration, numbered process flows, and AWS infrastructure boundaries (VPCs, subnets).

## Accessing the Diagram

### Option 1: React Component (Recommended)

The diagram is implemented as an interactive React component with hover effects, clickable process steps, and responsive design.

**Location**: `frontend/src/components/ArchitectureDiagram.tsx`

**To view**:
```bash
cd frontend
npm install
npm run dev
# Navigate to http://localhost:5173/architecture
```

### Option 2: Standalone HTML

A standalone HTML version can be generated for presentations or documentation.

## Architecture Components

### 1. System Boundaries

#### On-Premise Infrastructure
- **Boundary Color**: Green dashed border
- **Components**:
  - MySQL Database (172.20.10.4:3306)
  - 26 tables (10 main + 16 system-specific)

#### AWS Cloud (us-east-1)
- **Boundary Color**: Orange dashed border
- **Contains**: VPC, subnets, and managed services

#### User Zone
- **Boundary Color**: Blue dashed border
- **Components**:
  - React Frontend
  - End User

### 2. VPC Structure (10.0.0.0/16)

#### Public Subnet (10.0.1.0/24)
- **Components**:
  - API Gateway (REST API)
  - WAF (OWASP Rules)
- **Purpose**: Internet-facing services

#### Private Subnet 1 (10.0.2.0/24)
- **Components**:
  - Auth Lambda (Java 17)
  - Lambda Authorizer (JWT Verification)
  - Analytics Lambda (Python 3.11)
- **Purpose**: Serverless compute functions

#### Private Subnet 2 (10.0.3.0/24)
- **Components**:
  - DMS Instance (CDC Enabled)
  - AWS Batch (Rawâ†’Curated)
  - AWS Batch (Curatedâ†’Prod)
- **Purpose**: Data processing and migration

### 3. Managed Services (Outside VPC)

#### Data Services
- **S3 Data Lake**: Raw / Curated / Prod buckets (Parquet format)
- **Glue Catalog**: Schema discovery, 26 tables
- **Athena**: Serverless SQL queries

#### Storage & Security
- **DynamoDB**: Users table
- **Secrets Manager**: JWT secret, MySQL password
- **EventBridge**: S3 events, Batch triggers

### 4. Five AI Systems

Each system has dedicated dashboards and analytics capabilities:

1. **Market Intelligence Hub** ğŸ“ˆ
   - Technologies: ARIMA, Prophet, LSTM
   - Purpose: Market forecasting and trend analysis

2. **Demand Insights Engine** ğŸ¯
   - Technologies: XGBoost, K-Means
   - Purpose: Customer segmentation and demand forecasting

3. **Compliance Guardian** ğŸ›¡ï¸
   - Technologies: Isolation Forest, Gradient Boosting
   - Purpose: Fraud detection and compliance monitoring

4. **Retail Copilot** ğŸ¤–
   - Technologies: LLM, Natural Language to SQL
   - Purpose: AI assistant for retail operations

5. **Global Market Pulse** ğŸŒ
   - Technologies: Geospatial analysis, MCDA
   - Purpose: Global market trends and opportunities

## Process Flow (12 Steps)

### User Request Flow (Steps 1-8)

**Step 1: User Authentication**
- User logs in via React frontend
- JWT token generated by Auth Lambda
- Token stored in browser localStorage

**Step 2: Dashboard Access**
- User selects one of 5 AI system dashboards
- JWT token passed in Authorization header

**Step 3: API Request**
- Frontend sends HTTPS request to API Gateway
- Request includes JWT token for authentication

**Step 4: Token Verification**
- Lambda Authorizer verifies JWT token
- Checks token against secret in Secrets Manager
- Generates IAM policy for request

**Step 5: Analytics Query**
- Analytics Lambda receives authorized request
- Prepares Athena query with SQL injection prevention
- Validates table and column names against whitelist

**Step 6: Athena Execution**
- Athena executes SQL query
- Queries against Glue Catalog tables
- Reads data from S3 prod buckets

**Step 7: Data Retrieval**
- Athena reads Parquet files from S3
- Processes query and returns results
- Results cached for performance

**Step 8: Response to User**
- Data flows back through Lambda â†’ API Gateway â†’ Frontend
- Frontend visualizes data in dashboard
- Charts, tables, and insights displayed

### Data Pipeline Flow (Steps 9-12)

**Step 9: DMS Replication (Continuous)**
- DMS continuously monitors MySQL for changes
- Change Data Capture (CDC) detects inserts/updates/deletes
- Replicates changes to S3 raw buckets within 5 minutes
- Data written in Parquet format

**Step 10: Raw Data Processing**
- S3 event notification triggers EventBridge
- EventBridge invokes AWS Batch job
- Batch job (Python container) performs:
  - Schema validation
  - Data quality checks
  - Deduplication (keeps most recent)
  - PCI DSS compliance checks
  - Business rule validation
- Valid data written to curated bucket

**Step 11: Curated to Prod Transformation**
- S3 event notification triggers EventBridge
- EventBridge invokes AWS Batch job
- Batch job performs:
  - Data transformations
  - Denormalization for analytics
  - Partitioning by date
  - Optimization for Athena
- Transformed data written to prod bucket

**Step 12: Catalog Update**
- S3 event triggers Glue Crawler
- Crawler scans prod bucket
- Infers schema automatically
- Updates Glue Catalog with table metadata
- Tables now queryable via Athena

## Interactive Features

### Hover Effects
- **Component Highlighting**: Hover over any component to see it highlighted
- **Related Steps**: Hovering highlights related process flow steps
- **Glow Animation**: Active components pulse with a green glow

### Clickable Process Steps
- Click any process step to expand its description
- Selected steps remain highlighted
- Click again to collapse

### Responsive Design
- Adapts to different screen sizes
- Mobile-friendly layout
- Print-optimized styles

## Color Coding

### Boundaries
- **Green**: On-Premise Infrastructure
- **Orange**: AWS Cloud
- **Blue**: User Zone

### Subnets
- **Light Blue**: Public Subnet
- **Purple**: Private Subnets

### Components
- **Green**: MySQL Database
- **Blue**: API Gateway
- **Orange**: Lambda Functions
- **Purple**: DMS
- **Cyan**: Batch Jobs
- **Red**: S3 Buckets
- **Indigo**: Athena
- **Deep Purple**: Glue

### Process Flow Numbers
- **Purple Gradient**: Numbered circles (1-12)
- **White Border**: High visibility

## Technical Implementation

### React Component Structure

```typescript
ArchitectureDiagram
â”œâ”€â”€ Process Flow Panel
â”‚   â””â”€â”€ 12 Interactive Process Steps
â”œâ”€â”€ Main Diagram
â”‚   â”œâ”€â”€ On-Premise Boundary
â”‚   â”‚   â””â”€â”€ MySQL Database
â”‚   â”œâ”€â”€ AWS Cloud Boundary
â”‚   â”‚   â”œâ”€â”€ VPC
â”‚   â”‚   â”‚   â”œâ”€â”€ Public Subnet
â”‚   â”‚   â”‚   â”œâ”€â”€ Private Subnet 1
â”‚   â”‚   â”‚   â””â”€â”€ Private Subnet 2
â”‚   â”‚   â””â”€â”€ Managed Services
â”‚   â”‚       â”œâ”€â”€ Data Services
â”‚   â”‚       â””â”€â”€ Storage & Security
â”‚   â””â”€â”€ User Zone
â”‚       â””â”€â”€ Frontend + User
â”œâ”€â”€ AI Systems Panel
â”‚   â””â”€â”€ 5 AI System Cards
â””â”€â”€ Legend
```

### State Management

```typescript
const [selectedStep, setSelectedStep] = useState<number | null>(null);
const [hoveredComponent, setHoveredComponent] = useState<string | null>(null);
```

### Styling Approach

- **CSS Grid**: Responsive layout
- **Flexbox**: Component alignment
- **CSS Animations**: Hover effects, pulse, glow
- **Gradients**: Modern visual appeal
- **Box Shadows**: Depth and hierarchy

## Usage Examples

### Embedding in Documentation

```tsx
import ArchitectureDiagram from './components/ArchitectureDiagram';

function Documentation() {
  return (
    <div>
      <h1>System Architecture</h1>
      <ArchitectureDiagram />
    </div>
  );
}
```

### Standalone Page

```tsx
import Architecture from './pages/Architecture';

// In App.tsx routing
<Route path="/architecture" element={<Architecture />} />
```

### Presentation Mode

The diagram can be used in presentations:
1. Open in browser
2. Press F11 for fullscreen
3. Click through process steps to explain flow
4. Hover over components to highlight relationships

## Customization

### Adding New Components

```tsx
<div 
  className={`component new-service ${hoveredComponent === 'new-service' ? 'highlight' : ''}`}
  onMouseEnter={() => setHoveredComponent('new-service')}
  onMouseLeave={() => setHoveredComponent(null)}
>
  <div className="component-icon">ğŸ†•</div>
  <div className="component-name">New Service</div>
  <div className="component-detail">Description</div>
  <div className="flow-number">13</div>
</div>
```

### Adding New Process Steps

```typescript
{
  id: 13,
  title: "New Process Step",
  description: "Description of the new step",
  component: "new-service"
}
```

### Styling New Components

```css
.new-service {
  background: linear-gradient(135deg, #color1 0%, #color2 100%);
  color: white;
}
```

## Export Options

### PDF Export

```javascript
// Using browser print
window.print();
```

### PNG Export

```javascript
// Using html2canvas
import html2canvas from 'html2canvas';

const exportDiagram = async () => {
  const element = document.querySelector('.architecture-diagram');
  const canvas = await html2canvas(element);
  const link = document.createElement('a');
  link.download = 'architecture-diagram.png';
  link.href = canvas.toDataURL();
  link.click();
};
```

### SVG Export

The diagram can be converted to SVG for scalable graphics.

## Performance Considerations

- **Lazy Loading**: Components load on demand
- **CSS Animations**: Hardware-accelerated transforms
- **Event Delegation**: Efficient event handling
- **Memoization**: React.memo for expensive components

## Accessibility

- **Keyboard Navigation**: Tab through interactive elements
- **ARIA Labels**: Screen reader support
- **High Contrast**: Readable color combinations
- **Focus Indicators**: Clear focus states

## Browser Compatibility

- âœ… Chrome 90+
- âœ… Firefox 88+
- âœ… Safari 14+
- âœ… Edge 90+

## Future Enhancements

1. **Animation Timeline**: Animated data flow visualization
2. **Zoom Controls**: Pan and zoom for large diagrams
3. **Export Formats**: PDF, SVG, PNG export buttons
4. **Dark Mode**: Alternative color scheme
5. **Real-time Metrics**: Live system status indicators
6. **Interactive Tooltips**: Detailed component information
7. **Comparison View**: Before/after architecture views
8. **3D Visualization**: Three-dimensional architecture view

## Related Documentation

- [Frontend README](frontend/README.md)
- [Architecture Design](.kiro/specs/ecommerce-ai-platform/design.md)
- [System Requirements](.kiro/specs/ecommerce-ai-platform/requirements.md)
- [Terraform Infrastructure](terraform/README.md)

## Support

For questions or issues with the architecture diagram:
1. Check component props and state
2. Verify CSS imports
3. Review browser console for errors
4. Check responsive breakpoints

---

**Component**: ArchitectureDiagram.tsx  
**Styling**: ArchitectureDiagram.css  
**Page**: Architecture.tsx  
**Interactive**: Yes  
**Responsive**: Yes  
**Print-Ready**: Yes
